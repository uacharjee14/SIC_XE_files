Will modify pass 2 later for optimisation.. code is working fine for the examples i've tried so far